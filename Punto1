mkdir ~/modulo_parcial
cd ~/modulo_parcial


nano simple.c 


#include <linux/init.h>    
#include <linux/module.h>  
#include <linux/kernel.h>  
#include <linux/gcd.h>    
#include <linux/jiffies.h> 
#include <linux/param.h>   
#include <linux/hash.h>   

static int __init simple_init(void) {
    unsigned long gcd_result = gcd(3300, 24); //Calcula el MCD entre 3300 y 24

    printk(KERN_INFO "Loading Kernel Module\n");
    printk(KERN_INFO "GOLDEN_RATIO_PRIME: %lu\n", GOLDEN_RATIO_PRIME);
    printk(KERN_INFO "HZ (ticks por segundo): %d\n", HZ);
    printk(KERN_INFO "Valor actual de jiffies: %lu\n", jiffies);
    printk(KERN_INFO "GCD(3300, 24) = %lu\n", gcd_result);
    return 0;
}

static void __exit simple_exit(void) {
    printk(KERN_INFO "Removing Kernel Module\n"); 
    printk(KERN_INFO "Final jiffies value: %lu\n", jiffies);  

}

module_init(simple_init);     
module_exit(simple_exit);    
 
MODULE_LICENSE("GPL");
MODULE_DESCRIPTION("Simple Module");
MODULE_AUTHOR("Cristian_Fabian");

//GUARDAR Y SALIR CTR+O Y LUEGO CTR+X

nano makefile

obj-m += simple.o  

all:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules 

clean:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean 

//GUARDAR Y SALIR CTR+O Y LUEGO CTR+X 

make

sudo insmod simple.ko 

lsmod | grep simple 

sudo dmesg | tail -20 

sudo rmmod simple //remueve o descarga el módulo "simple" cargado

sudo dmesg | tail -20 //muestra el mensaje de simple_exit porque ya se descargo ese módulo

exit
